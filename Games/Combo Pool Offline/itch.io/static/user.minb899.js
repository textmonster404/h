(function(){var is_different,hasProp={}.hasOwnProperty,slice=[].slice;if(window.R){return}is_different=function(a,b){var key;for(key in a){if(!hasProp.call(a,key))continue;if(a[key]!==b[key]){return true}}for(key in b){if(!hasProp.call(b,key))continue;if(!(key in a)){return true}}return false};window.R=function(name,data,p,prefix){var cl,class_name;if(p==null){p=R}if(prefix==null){prefix=""}data.trigger=function(){var node;node=$(ReactDOM.findDOMNode(this));R.trigger.apply(R,[node].concat(slice.call(arguments)));return void 0};data.dispatch=function(){var node;node=$(ReactDOM.findDOMNode(this));R.dispatch.apply(R,[node].concat(slice.call(arguments)));return void 0};data.container=function(){return $(ReactDOM.findDOMNode(this))};data.extend_props=function(){var more;more=1<=arguments.length?slice.call(arguments,0):[];return $.extend.apply($,[{},this.props].concat(slice.call(more)))};class_name=_.once(function(){return(""+prefix+name).replace(/[A-Z]/g,"_$&").replace(/\./g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").toLowerCase()+"_widget"});data.enclosing_class_name=class_name;data.enclose=function(){var args,component,props;props=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[];component=props.component||"div";delete props.component;return React.createElement.apply(React,[component,$.extend({},props,{className:classNames(class_name(),props.className)})].concat(slice.call(args)))};data.displayName=""+prefix+name;if(data.pure){data.shouldComponentUpdate=function(nextProps,nextState){return is_different(this.props,nextProps)||is_different(this.state,nextState)}}cl=React.createClass(data);p[name]=React.createFactory(cl);return p[name]._class=cl};R.scope_event_name=function(name){return"itch:"+name};R.trigger=function(){var args,name,node;node=arguments[0],name=arguments[1],args=3<=arguments.length?slice.call(arguments,2):[];return node.trigger(R.scope_event_name(name),slice.call(args))};R.dispatch=function(node,prefix,event_table){var event_name,fn,results;if(typeof prefix==="object"){event_table=prefix;prefix=false}results=[];for(event_name in event_table){if(!hasProp.call(event_table,event_name))continue;fn=event_table[event_name];if(prefix){event_name=prefix+":"+event_name}results.push(node.on(R.scope_event_name(event_name),fn))}return results};R.component=function(){return R.apply(null,arguments)};R["package"]=function(_this){return function(prefix){var p;p=R[prefix]||(R[prefix]=function(name,data){data.Package=p;return R.component(name,data,p,prefix+".")});p.component=function(){return p.apply(null,arguments)};return p}}(this)}).call(this);(function(){var P,a,br,button,c,code,div,em,fieldset,form,h1,h2,h3,h4,h5,h6,iframe,img,input,label,legend,li,ol,optgroup,option,p,pre,ref,section,select,span,strong,textarea,types,ul,slice=[].slice;if(!this.React){return}ref=React.DOM,div=ref.div,span=ref.span,a=ref.a,br=ref.br,p=ref.p,ol=ref.ol,ul=ref.ul,li=ref.li,strong=ref.strong,em=ref.em,img=ref.img,form=ref.form,label=ref.label,input=ref.input,textarea=ref.textarea,button=ref.button,iframe=ref.iframe,h1=ref.h1,h2=ref.h2,h3=ref.h3,h4=ref.h4,h5=ref.h5,h6=ref.h6,pre=ref.pre,code=ref.code,select=ref.select,option=ref.option,section=ref.section,optgroup=ref.optgroup,fieldset=ref.fieldset,legend=ref.legend;if(R.Redactor){return}c=function(_this){return function(){return R.component.apply(R,arguments)}}(this);types=React.PropTypes;c("Redactor",{componentDidMount:function(){return I.redactor($(ReactDOM.findDOMNode(this)),{minHeight:80,source:false})},render:function(){return textarea({name:this.props.name,value:this.props.value,defaultValue:this.props.defaultValue})}});c("CSRF",{pure:true,render:function(){return input({type:"hidden",name:"csrf_token",value:$("meta[name=csrf_token]").attr("value")})}});P=R["package"]("Forms");P("TextInputRow",{pure:true,propTypes:{title:types.string,sub:types.any,name:types.string.isRequired,value:types.any},componentDidMount:function(){var valid_slug_chars;if(this.props.money_input){if(!this.props.currency){throw new Error("missing currency")}I.money_input(this.refs.input,{currency:this.props.currency})}if(this.props.slug_input){I.slug_input($(this.refs.input))}if(this.props.integer_input){valid_slug_chars=/[0-9]/g;return $(this.refs.input).on("keypress",function(_this){return function(e){var char;if(e.keyCode>=32){char=String.fromCharCode(e.keyCode);if(!char.match(valid_slug_chars)){return false}}}}(this))}},render:function(){var inside;inside=[div({className:"label"},this.props.title,this.props.sub?span({className:"sub"}," — ",this.props.sub):void 0),input({type:"text",name:this.props.name,ref:"input",value:this.props.value,defaultValue:this.props.defaultValue,onChange:this.props.onChange,onKeyUp:this.props.onKeyUp,className:classNames({has_error:this.props.has_error}),required:this.props.required,placeholder:this.props.placeholder,disabled:this.props.disabled,pattern:this.props.pattern}),this.props.error_message?p({className:"input_error"},this.props.error_message):void 0];if(!this.props.multi){inside=label({children:inside})}return div({className:"input_row",children:inside})}});P("SimpleSelect",{propTypes:{options:types.array.isRequired,name:types.string},getInitialState:function(){return{}},render:function(){var children,current,current_group,push_group,render_current_option;current=this.current_option();render_current_option=this.props.render_current_option;render_current_option||(render_current_option=function(_this){return function(current){return current.short_name||current.name}}(this));children=[];current_group=null;push_group=function(){if(!current_group){return}children.push(optgroup.apply(null,[{label:current_group.label}].concat(slice.call(current_group.children))));return current_group=null};this.props.options.map(function(_this){return function(o,idx){var opt;opt=option({key:""+idx,value:o.value},o.name);if(o.group){if((current_group!=null?current_group.label:void 0)!==o.group){push_group()}current_group||(current_group={label:o.group,children:[]});return current_group.children.push(opt)}else{push_group();return children.push(opt)}}}(this));push_group();return this.enclose({className:classNames({focused:this.state.focused,disabled:this.props.disabled}),children:[div({className:"selected_option"},span({className:"selected_option_name"},render_current_option(current)),span({className:"icon icon-triangle-down"})),select({disabled:this.props.disabled,value:current.value,name:this.props.name,onFocus:function(_this){return function(e){return _this.setState({focused:true})}}(this),onBlur:function(_this){return function(e){return _this.setState({focused:false})}}(this),onChange:this.on_change,children:children})]})},on_change:function(e){var value;value=e.target.value;if(this.props.onChange){if(value===this.props.value){return}return this.props.onChange(value)}else{if(value===this.state.value){return}return this.setState({value:value})}},find_option:function(value){var i,len,opt,ref1;ref1=this.props.options;for(i=0,len=ref1.length;i<len;i++){opt=ref1[i];if(opt.value===value){return opt}}},current_option:function(){var current,search_value;search_value=this.props.value||this.state.value;current=search_value!=null?this.find_option(search_value):void 0;return current||this.props.options[0]}});P("Select",{propTypes:{name:types.string.isRequired,value:types.any,options:types.array.isRequired},componentDidMount:function(){var el,opts;if(!this.props.selectize){return}opts=this.props.selectize===true?{}:this.props.selectize;el=$(this.refs.input);el.selectize(opts);if(this.props.onChange){return el.on("change",function(_this){return function(e){return _this.props.onChange(e)}}(this))}},render:function(){return select({ref:"input",name:this.props.name,onChange:this.props.onChange,value:this.props.value,defaultValue:this.props.defaultValue,children:this.props.options.map(function(_this){return function(arg){var label,value;value=arg[0],label=arg[1];return option({value:value},label||value)}}(this))})}});P("RadioButtons",{propTypes:{name:types.string.isRequired,value:types.any,options:types.array.isRequired},getValue:function(){var i,len,name,ref1,ref2,value;ref1=this.container().find("input").serializeArray();for(i=0,len=ref1.length;i<len;i++){ref2=ref1[i],name=ref2.name,value=ref2.value;return value}},render:function(){return ul({className:"radio_list",children:this.props.options.map(function(_this){return function(arg){var input_label,more_opts,sub,value;value=arg[0],input_label=arg[1],sub=arg[2],more_opts=arg[3];return li({className:classNames({disabled:more_opts!=null?more_opts.disabled:void 0})},label({children:[input($.extend({type:"radio",name:_this.props.name,value:value,defaultChecked:_this.props.defaultValue?value===_this.props.defaultValue:void 0,checked:_this.props.value!=null?value===_this.props.value:void 0,onChange:_this.props.onChange},more_opts)),span({className:"radio_label"},input_label),sub?span({className:"sub",children:[" — ",sub]}):void 0]}))}}(this))})}});P("ColorInput",{propTypes:{name:types.string,value:types.any,defaultValue:types.any,allow_empty:types.bool},palette:["#193D3F","#3F2832","#743F39","#9E2835","#B86F50","#327345","#E53B44","#4F6781","#0484D1","#FB922B","#AFBFD2","#63C64D","#E4A672","#2CE8F4","#FFE762"],componentDidMount:function(){var base;(base=R.Forms.ColorInput).active_inputs||(base.active_inputs=[]);R.Forms.ColorInput.active_inputs.push(this);if(!$._farbtastic){throw new Error("Need farb to create color picker")}this.farb=new $._farbtastic($());if(c=this.props.defaultValue){this.farb.setColor(c)}return this.refresh_preview=_.debounce(function(){return this.set_color_from_input(false)},500)},componentDidUpdate:function(prev_props,prev_state){var current_value,new_value,popup_farb;current_value=prev_props.value||"";new_value=this.props.value||"";if(current_value!==new_value){if(c=this.set_color(new_value)){this.refs.input.value=c}}if(!prev_state.open&&this.state.open){popup_farb=$.farbtastic($(this.refs.farb),function(_this){return function(color){if(c=_this.set_color(color)){return _this.refs.input.value=c}}}(this));if(this.state.last_value){popup_farb.setColor(this.state.last_value)}return this.setState({popup_farb:popup_farb})}},getInitialState:function(){return{open:false,last_value:this.props.value||this.props.defaultValue||""}},set_color_from_input:function(){var color,f;if(!this.refs.input){return}color=this.set_color.apply(this,[this.refs.input.value].concat(slice.call(arguments)));if(!color){return}if(color!==this.refs.input.value){this.refs.input.value=color}if(f=this.state.popup_farb){return f.setColor(color)}},set_color:function(color,fix_input){var base,base1;if(fix_input==null){fix_input=true}color||(color="");if(this.props.allow_empty&&color===""){this.farb.setColor("#ffffff");this.setState({last_value:""});if(fix_input){this.refs.input.value=""}if(typeof(base=this.props).onChange==="function"){base.onChange("")}return""}if(!color.match(/^#/)){color="#"+color}this.farb.setColor(color);if(color===this.farb.color){this.setState({last_value:color});if(typeof(base1=this.props).onChange==="function"){base1.onChange(color)}return color}else{if(fix_input){this.refs.input.value=this.state.last_value||""}return false}},open:function(){if(this.state.open){return}this.setState({open:true,on_left:this.popup_on_left()});this.click_outside_handler||(this.click_outside_handler=function(_this){return function(e){var self;self=ReactDOM.findDOMNode(_this);if($(e.target).closest(self).length){return}return _this.close()}}(this));return $(document.body).on("mousedown",this.click_outside_handler)},componentWillUnmount:function(){if(this.click_outside_handler){return $(document.body).off("mousedown",this.click_outside_handler)}},close:function(){if(!this.state.open){return}this.setState({open:false,popup_farb:void 0});return $("document.body").off("mousedown",this.click_outside_handler)},popup_on_left:function(){var el,popup_right;el=$(ReactDOM.findDOMNode(this));popup_right=el.offset().left+el.width()+250;return popup_right>$(window).width()+$(window).scrollLeft()},render_color_popout:function(){var palette;palette=this.props.palette||this.palette;return div({className:"color_popout",children:[this.props.allow_empty&&this.state.last_value?button({type:"button",className:"clear_color_btn",onClick:function(_this){return function(){return _this.set_color("")}}(this)},"Clear"):void 0,div({className:"farb_drop",ref:"farb"}),palette?div({className:"palette_options"},palette.map(function(_this){return function(color){return button({key:color,type:"button",style:{backgroundColor:color},onClick:function(e){return _this.set_color(color)}},color)}}(this))):void 0]})},render:function(){var current_color;current_color=this.state.last_value||"#ffffff";return this.enclose({className:classNames(this.props.className,{picker_open:this.state.open,picker_left:this.state.on_left}),children:[input({ref:"input",type:"text",className:"color_text_input",name:this.props.name,defaultValue:this.props.value||this.props.defaultValue,placeholder:this.props.defaultValue||"Color",onBlur:this.set_color_from_input,onFocus:this.open,onKeyDown:function(_this){return function(e){switch(e.keyCode){case 9:_this.close();break;case 13:_this.set_color_from_input();e.preventDefault()}return _this.refresh_preview()}}(this)}),div({className:"color_swatch",onClick:this.open,style:{backgroundColor:current_color}}),this.state.open?this.render_color_popout():void 0]})}});P("Slider",{propTypes:{min:types.number,max:types.number,value:types.number,onChange:types.func,disabled:types.bool},getInitialState:function(){return{}},on_change:function(value){value=Math.round(value);if(this.props.onChange){if(this.props.value===value){return}return this.props.onChange(value)}else{if(this.state.value===value){return}return this.setState({value:value})}},start_drag:function(start_x,start_y){var move_listener,start_value,up_listener,width;if(this.props.disabled){return}width=this.refs.track.clientWidth;start_value=this.current_value();this.setState({dragging:true});move_listener=function(_this){return function(e){var dx,new_value,x,y;if(e.buttons===0){up_listener();return}x=e.pageX;y=e.pageX;dx=x-start_x;new_value=dx/width*(_this.props.max-_this.props.min)+start_value;new_value=Math.min(_this.props.max,Math.max(_this.props.min,new_value));if(new_value!==_this.current_value()){return _this.on_change(new_value)}}}(this);up_listener=function(_this){return function(e){_this.setState({dragging:false});document.body.removeEventListener("mousemove",move_listener);document.body.removeEventListener("mouseup",up_listener);return delete _this.up_listener}}(this);document.body.addEventListener("mousemove",move_listener);document.body.addEventListener("mouseup",up_listener);return this.up_listener=up_listener},current_value:function(){if("value"in this.state){return this.state.value||this.props.min}else{return this.props.value||this.props.min}},percent:function(){return(this.current_value()-this.props.min)/(this.props.max-this.props.min)},componentWillUnmount:function(){if(this.up_listener){return this.up_listener()}},render:function(){var offset_style;offset_style={left:this.percent()*100+"%"};return this.enclose({className:classNames("slider_input",{disabled:this.props.disabled}),onClick:function(_this){return function(e){var new_value,rect;if(e.target===_this.refs.slider_nub){return}rect=_this.refs.track.getBoundingClientRect();p=Math.min(rect.width,Math.max(0,e.pageX-rect.left))/rect.width;new_value=_this.props.min+p*(_this.props.max-_this.props.min);new_value=Math.min(_this.props.max,Math.max(_this.props.min,new_value));if(new_value!==_this.current_value()){return _this.on_change(new_value)}}}(this),children:[this.props.name?input({type:"hidden",name:this.props.name,value:this.current_value()}):void 0,div({ref:"track",className:"slider_track"},div({className:"slider_fill",style:{width:this.percent()*100+"%"}}),this.state.focused&&this.props.show_tooltip?div({style:offset_style,className:"value_tooltip"},this.current_value()):void 0,button({type:"button",ref:"slider_nub",className:"slider_nub",onFocus:function(_this){return function(){return _this.setState({focused:true})}}(this),onBlur:function(_this){return function(){return _this.setState({focused:false})}}(this),onMouseDown:function(_this){return function(e){return _this.start_drag(e.pageX,e.pageY)}}(this),onKeyDown:function(_this){return function(e){switch(e.keyCode){case 37:_this.on_change(Math.max(_this.props.min,_this.current_value()-1));break;case 39:_this.on_change(Math.min(_this.props.max,_this.current_value()+1));break;default:return}return e.preventDefault()}}(this),style:offset_style}))]})}})}).call(this);(function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;I.UserPage=function(){UserPage.prototype.sticky_selector=".profile_column, .game_column";function UserPage(el,opts){this.opts=opts;this.on_change_mode=bind(this.on_change_mode,this);this.set_mode=bind(this.set_mode,this);this.el=$(el);if(!I.is_mobile()){this.el.find(".carousel_wrapper").removeClass("carousel_wrapper").addClass("antiscroll-wrap").antiscroll({x:true,y:false})}this.on_change_mode();this.setup_grid();this.setup_tracking();if(this.opts.ac){I.setup_affiliate_code(this.opts.ac)}this.el.find(".profile_banner").on("load",function(){return $(document.body).trigger("sticky_kit:recalc")})}UserPage.prototype.set_mode=function(mode){this.el.removeClass("mode_grid mode_column").addClass("mode_"+mode);return this.on_change_mode()};UserPage.prototype.on_change_mode=function(){var mode;mode=this.el.is(".mode_grid")?"grid":this.el.is(".mode_column")?"column":void 0;if(mode===this.last_mode){return}switch(mode){case"grid":if(this.last_mode==="column"){this.el.find(this.sticky_selector).trigger("sticky_kit:detach")}break;case"column":if(!(I.is_mobile()||$(window).width()<=800)){this.el.find(this.sticky_selector).stick_in_parent({offset_top:20})}}return this.last_mode=mode};UserPage.prototype.setup_grid=function(){return this.grid=new I.GameGrid(this.el.find(".user_game_grid"),{selector:".mode_grid .user_game_grid .game_cell .game_thumb",width_selector:".mode_grid .user_game_grid .game_cell",show_popups:false})};UserPage.prototype.setup_tracking=function(){I.setup_grid_referrers(this.el,function(_this){return function(){return"user:"+_this.opts.user_id}}(this));return I.tracked_links(this.el,"user")};return UserPage}();I.UserToolProfilePage=function(superClass){extend(UserToolProfilePage,superClass);function UserToolProfilePage(){UserToolProfilePage.__super__.constructor.apply(this,arguments);this.game_cells=this.grid.el.find(".game_cell");this.render_tool_tag_filter();this.render_grouped_games()}UserToolProfilePage.prototype.setup_grid=function(){return this.grid=new I.GameGrid(this.el.find(".user_game_grid"),{selector:".user_game_grid .game_cell .game_thumb",width_selector:".user_game_grid .game_cell",expected_size:280})};UserToolProfilePage.prototype.render_grouped_games=function(){var game,games,group,i,id,len,ref,results,seen_games;this.grid.el.empty();seen_games={};ref=this.opts.default_groups;results=[];for(i=0,len=ref.length;i<len;i++){group=ref[i];games=this.find_games_by_filter(group.filter);if(!games.length){continue}games=function(){var j,len1,results1;results1=[];for(j=0,len1=games.length;j<len1;j++){game=games[j];id=$(game).data("game_id");if(seen_games[id]){continue}seen_games[id]=true;results1.push(game)}return results1}();games=$(games);this.grid.el.append($("<h2></h2>").text(group.title));results.push(games.appendTo(this.grid.el))}return results};UserToolProfilePage.prototype.render_filtered_games=function(filter){this.grid.el.empty();return this.find_games_by_filter(filter).appendTo(this.grid.el)};UserToolProfilePage.prototype.find_games_by_filter=function(filter){var cell,found_count,key,out,tag_id,total_filters;total_filters=function(){var results;results=[];for(key in filter){if(!hasProp.call(filter,key))continue;results.push(key)}return results}().length;out=function(){var i,j,len,len1,ref,ref1,results;ref=this.game_cells;results=[];for(i=0,len=ref.length;i<len;i++){cell=ref[i];cell=$(cell);found_count=0;ref1=cell.data("tags")||[];for(j=0,len1=ref1.length;j<len1;j++){tag_id=ref1[j];if(filter[tag_id]){found_count+=1}}if(found_count===total_filters){results.push(cell[0])}else{continue}}return results}.call(this);return $(out)};UserToolProfilePage.prototype.render_tool_tag_filter=function(){var drop;drop=this.el.find(".tool_tags_filter_drop");return ReactDOM.render(R.User.ToolTags($.extend({on_select_tags:function(_this){return function(tags){if($.isEmptyObject(tags)){return _this.render_grouped_games()}else{return _this.render_filtered_games(tags)}}}(this)},this.opts.tool_tags_props)),drop[0])};return UserToolProfilePage}(I.UserPage)}).call(this);(function(){}).call(this);(function(){I.UserUserTools=function(){function UserUserTools(el){this.el=$(el);I.tracked_links(this.el,"view_user","user_tools");I.has_follow_button(this.el);setTimeout(function(_this){return function(){return _this.el.removeClass("hidden")}}(this),200)}return UserUserTools}();I.UserLayout=function(){function UserLayout(el){this.el=$(el);this.el.dispatch("click",{edit_theme_btn:function(_this){return function(btn){return I.user_appearance_editor.toggle()}}(this)});new I.UserUserTools(this.el.find(".user_tools"))}return UserLayout}()}).call(this);(function(){var P,a,br,button,code,div,em,fieldset,form,h1,h2,h3,h4,h5,h6,iframe,img,input,label,legend,li,ol,optgroup,option,p,pre,ref,section,select,span,strong,textarea,types,ul;if(!this.React){return}ref=React.DOM,div=ref.div,span=ref.span,a=ref.a,br=ref.br,p=ref.p,ol=ref.ol,ul=ref.ul,li=ref.li,strong=ref.strong,em=ref.em,img=ref.img,form=ref.form,label=ref.label,input=ref.input,textarea=ref.textarea,button=ref.button,iframe=ref.iframe,h1=ref.h1,h2=ref.h2,h3=ref.h3,h4=ref.h4,h5=ref.h5,h6=ref.h6,pre=ref.pre,code=ref.code,select=ref.select,option=ref.option,section=ref.section,optgroup=ref.optgroup,fieldset=ref.fieldset,legend=ref.legend;P=R["package"]("ThemeEditor");types=React.PropTypes;P("OrderPickerItem",{propTypes:{item:types.shape({id:types.number,order:types.number,name:types.string,hidden:types.bool,type:types.string},{position:types.number,input_name:types.string})},input_name:function(name){return this.props.input_name+"["+(this.props.position+1)+"]["+name+"]"},render:function(){var item;item=this.props.item;return div({"data-id":item.id,className:classNames("order_row",{dragging:this.props.dragging}),children:[input({type:"hidden",className:"position_input",name:this.input_name("id"),value:item.id}),this.props.item.hidden?input({type:"hidden",name:this.input_name("hidden"),value:"1"}):void 0,span({title:item.name},item.name),button({type:"button",className:classNames("hide_btn",{is_active:this.props.item.hidden}),onClick:function(_this){return function(e){e.preventDefault();return _this.trigger("order_picker_item:hidden",_this.props.item,!_this.props.item.hidden)}}(this)},"Hide")]})}});P("OrderPicker",{propTypes:{input_name:types.string,update_order:types.func,items:types.arrayOf(types.shape({id:types.number,name:types.string,hidden:types.bool,type:types.string}))},getInitialState:function(){return{items:this.props.items}},update_order:function(ids){var base,item,items,items_by_id,j,len,ref1;items_by_id={};ref1=this.state.items;for(j=0,len=ref1.length;j<len;j++){item=ref1[j];items_by_id[""+item.id]=item}items=ids.map(function(_this){return function(id){return items_by_id[id]}}(this));this.setState({items:items});return typeof(base=this.props).update_order==="function"?base.update_order(items):void 0},componentDidMount:function(){var el;el=$(this.refs.list);this.dispatch("order_picker_item",{hidden:function(_this){return function(e,item,hidden){var base,items;items=_this.state.items.map(function(list_item){if(item.id===list_item.id){return $.extend({},item,{hidden:hidden})}else{return list_item}});_this.setState({items:items});return typeof(base=_this.props).update_order==="function"?base.update_order(items):void 0}}(this)});return el.sortable({cancel:"button"}).on("sortstop",function(_this){return function(e){var order;order=el.sortable("toArray",{attribute:"data-id"});el.sortable("cancel");return _this.update_order(order)}}(this))},render:function(){return div({ref:"list",className:"sorting_picker",children:this.state.items.map(function(_this){return function(item,i){return R.ThemeEditor.OrderPickerItem({key:item.id,position:i,item:item,input_name:_this.props.input_name})}}(this))})}})}).call(this);(function(){var P,a,br,button,code,div,em,fieldset,form,h1,h2,h3,h4,h5,h6,iframe,img,input,label,legend,li,ol,optgroup,option,p,pre,ref,section,select,span,strong,textarea,types,ul;if(!this.React){return}ref=React.DOM,div=ref.div,span=ref.span,a=ref.a,br=ref.br,p=ref.p,ol=ref.ol,ul=ref.ul,li=ref.li,strong=ref.strong,em=ref.em,img=ref.img,form=ref.form,label=ref.label,input=ref.input,textarea=ref.textarea,button=ref.button,iframe=ref.iframe,h1=ref.h1,h2=ref.h2,h3=ref.h3,h4=ref.h4,h5=ref.h5,h6=ref.h6,pre=ref.pre,code=ref.code,select=ref.select,option=ref.option,section=ref.section,optgroup=ref.optgroup,fieldset=ref.fieldset,legend=ref.legend;P=R["package"]("User");types=React.PropTypes;P("GameGrid",{render:function(){return this.enclose({className:["game_grid_widget","user_game_grid"],children:this.props.games.map(function(_this){return function(game){return _this.render_game(game)}}(this))})},render_game:function(game){var thumb_style;thumb_style={backgroundColor:game.bg_color,backgroundImage:game.cover_image_url&&"url("+game.cover_image_url+")"};return div({className:classNames("game_cell",{has_cover:game.cover_image_url})},a({href:game.url,className:"thumb_link","data-label":"game:"+game.id+":thumb","data-action":"game_grid"},div({className:"game_thumb",style:thumb_style})),div({className:"game_cell_data",children:[div({className:"game_title"},a({href:game.url,className:"title","data-label":"game:"+game.id+":title","data-action":"game-grid"},game.title))]}))}});P("ToolTags",{getInitialState:function(){return{selected_tags:$.extend({},this.props.default_tags)}},componentDidMount:function(){},tags_by_id:function(){if(this._tags_by_id){return this._tags_by_id}this._tags_by_id={};this.props.tag_groups.forEach(function(_this){return function(group){return group.tags.forEach(function(tag){tag.group=group;return _this._tags_by_id[""+tag.id]=tag})}}(this));return this._tags_by_id},select_tag:function(id){var base,i,len,other_tag,ref1,selected_tags,tag;selected_tags=$.extend({},this.state.selected_tags);tag=this.tags_by_id()[id];ref1=tag.group.tags;for(i=0,len=ref1.length;i<len;i++){other_tag=ref1[i];delete selected_tags[other_tag.id]}selected_tags[tag.id]=true;this.setState({selected_tags:selected_tags});return typeof(base=this.props).on_select_tags==="function"?base.on_select_tags(selected_tags):void 0},unselect_group:function(group){var base,i,len,ref1,selected_tags,tag;selected_tags=$.extend({},this.state.selected_tags);ref1=group.tags;for(i=0,len=ref1.length;i<len;i++){tag=ref1[i];delete selected_tags[tag.id]}this.setState({selected_tags:selected_tags});return typeof(base=this.props).on_select_tags==="function"?base.on_select_tags(selected_tags):void 0},render:function(){var dropdowns;dropdowns=this.props.tag_groups.map(function(_this){return function(group){var options,selected_tag;selected_tag=group.tags.find(function(t){if(_this.state.selected_tags[t.id]){return true}});options=group.tags.map(function(tag){return{name:tag.name,value:tag.id}});if(!options.length){return}options.unshift({name:"Any",value:""});return R.Forms.SimpleSelect({key:group.slug,name:group.slug,value:(selected_tag!=null?selected_tag.id:void 0)||"default",render_current_option:function(current){if(current.value===""){return group.name}else{return strong({},current.name)}},onChange:function(value){var tag;tag=_this.tags_by_id()[value];if(tag){return _this.select_tag(tag.id)}else{return _this.unselect_group(group)}},options:options})}}(this));return this.enclose({},label({},"Filter games"),dropdowns,!$.isEmptyObject(this.state.selected_tags)?div({className:"clear_area"},a({href:"javascript:void(0)",onClick:function(_this){return function(e){var base;e.preventDefault();_this.setState({selected_tags:{}});return typeof(base=_this.props).on_select_tags==="function"?base.on_select_tags({}):void 0}}(this)},"Clear filters")):void 0)}})}).call(this);
